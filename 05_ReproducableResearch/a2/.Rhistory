storm_us$EVTYPE[grepl('fog.*cold',storm_us$EVTYPE,ignore.case = TRUE) | grepl('ice.*fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[18]
storm_us$EVTYPE[grepl('hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[19]
storm_us$EVTYPE[grepl('heat|warm|hot|high temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[20]
storm_us$EVTYPE[grepl('rain|precipitation|shower|wet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[21]
storm_us$EVTYPE[grepl('snow',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[22]
storm_us$EVTYPE[grepl('surf|high wave|high swell|high seas',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[23]
storm_us$EVTYPE[grepl('wind',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('marine',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('thunderstorm|tstm.*wind',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[24]
storm_us$EVTYPE[grepl('hurric|typh',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('ice.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[26]
storm_us$EVTYPE[grepl('lightning',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[29]
storm_us$EVTYPE[grepl('marine.*hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[30]
storm_us$EVTYPE[grepl('rip.*cur',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[34]
storm_us$EVTYPE[grepl('sleet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[36]
storm_us$EVTYPE[grepl('High Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('thunderstorm|tstm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[39]
storm_us$EVTYPE[grepl('tornado',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tornado debris',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tropical.*depression',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[41]
storm_us$EVTYPE[grepl('tropical.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[42]
storm_us$EVTYPE[grepl('volcanic.*ash',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[44]
storm_us$EVTYPE[grepl('waterspout',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[45]
storm_us$EVTYPE[grepl('fire',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[46]
storm_us$EVTYPE[grepl('wint.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[47]
storm_us$EVTYPE[grepl('wint',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[48]
official_storm_events[25]
sum(grepl('hurric|typh',storm_us$EVTYPE,ignore.case = TRUE))
sum(grepl('hurric',storm_us$EVTYPE,ignore.case = TRUE))
sum(grepl('typh',storm_us$EVTYPE,ignore.case = TRUE))
sum(grepl('typh',storm$EVTYPE,ignore.case = TRUE))
sum(grepl('hurric',storm$EVTYPE,ignore.case = TRUE))
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
storm_us$EVTYPE[grepl('Low Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[1]
storm_us$EVTYPE[grepl('^avala',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[2]
storm_us$EVTYPE[grepl('blizz',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[3]
storm_us$EVTYPE[grepl('cold|wind.*chill|cool|low temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[5]
storm_us$EVTYPE[grepl('dense fog',storm_us$EVTYPE,ignore.case = TRUE) | grepl('^fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[7]
storm_us$EVTYPE[grepl('smoke',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[8]
storm_us$EVTYPE[grepl('drought|dry',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[9]
storm_us$EVTYPE[grepl('dust.*dev',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[10]
storm_us$EVTYPE[grepl('dust',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('devil',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[11]
storm_us$EVTYPE[grepl('flood',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[15]
storm_us$EVTYPE[grepl('frost|freez',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[16]
storm_us$EVTYPE[grepl('funnel',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[17]
storm_us$EVTYPE[grepl('fog.*cold',storm_us$EVTYPE,ignore.case = TRUE) | grepl('ice.*fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[18]
storm_us$EVTYPE[grepl('hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[19]
storm_us$EVTYPE[grepl('heat|warm|hot|high temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[20]
storm_us$EVTYPE[grepl('rain|precipitation|shower|wet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[21]
storm_us$EVTYPE[grepl('snow',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[22]
storm_us$EVTYPE[grepl('surf|high wave|high swell|high seas',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[23]
storm_us$EVTYPE[grepl('wind',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('marine',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('thunderstorm|tstm.*wind',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[24]
storm_us$EVTYPE[grepl('hurric',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('typh',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('ice.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[26]
storm_us$EVTYPE[grepl('lightning',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[29]
storm_us$EVTYPE[grepl('marine.*hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[30]
storm_us$EVTYPE[grepl('rip.*cur',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[34]
storm_us$EVTYPE[grepl('sleet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[36]
storm_us$EVTYPE[grepl('High Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('thunderstorm|tstm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[39]
storm_us$EVTYPE[grepl('tornado',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tornado debris',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tropical.*depression',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[41]
storm_us$EVTYPE[grepl('tropical.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[42]
storm_us$EVTYPE[grepl('volcanic.*ash',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[44]
storm_us$EVTYPE[grepl('waterspout',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[45]
storm_us$EVTYPE[grepl('fire',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[46]
storm_us$EVTYPE[grepl('wint.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[47]
storm_us$EVTYPE[grepl('wint',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[48]
official_storm_events <- c("Astronomical Low Tide","Avalanche","Blizzard","Coastal Flood","Cold/Wind Chill","Debris Flow","Dense Fog","Dense Smoke","Drought","Dust Devil","Dust Storm","Excessive Heat","Extreme Cold/Wind Chill","Flash Flood","Flood","Frost/Freeze","Funnel Cloud","Freezing Fog","Hail","Heat","Heavy Rain","Heavy Snow","High Surf","High Wind","Hurricane/Typhoon","Ice Storm","Lake-Effect Snow","Lakeshore Flood","Lightning","Marine Hail","Marine High Wind","Marine Strong Wind","Marine Thunderstorm Wind","Rip Current","Seiche","Sleet","Storm Surge/Tide","Strong Wind","Thunderstorm Wind","Tornado","Tropical Depression","Tropical Storm","Tsunami","Volcanic Ash","Waterspout","Wildfire","Winter Storm","Winter Weather")
official_storm_events <- toupper(official_storm_events)
official_storm_events
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
storm_us$EVTYPE[grepl('Low Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[1]
storm_us$EVTYPE[grepl('^avala',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[2]
storm_us$EVTYPE[grepl('blizz',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[3]
storm_us$EVTYPE[grepl('cold|wind.*chill|cool|low temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[5]
storm_us$EVTYPE[grepl('dense fog',storm_us$EVTYPE,ignore.case = TRUE) | grepl('^fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[7]
storm_us$EVTYPE[grepl('smoke',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[8]
storm_us$EVTYPE[grepl('drought|dry',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[9]
storm_us$EVTYPE[grepl('dust.*dev',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[10]
storm_us$EVTYPE[grepl('dust',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('devil',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[11]
storm_us$EVTYPE[grepl('flood',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[15]
storm_us$EVTYPE[grepl('frost|freez',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[16]
storm_us$EVTYPE[grepl('funnel',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[17]
storm_us$EVTYPE[grepl('fog.*cold',storm_us$EVTYPE,ignore.case = TRUE) | grepl('ice.*fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[18]
storm_us$EVTYPE[grepl('hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[19]
storm_us$EVTYPE[grepl('heat|warm|hot|high temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[20]
storm_us$EVTYPE[grepl('rain|precipitation|shower|wet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[21]
storm_us$EVTYPE[grepl('snow',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[22]
storm_us$EVTYPE[grepl('surf|high wave|high swell|high seas',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[23]
storm_us$EVTYPE[grepl('wind',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('marine',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('thunderstorm|tstm.*wind',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[24]
storm_us$EVTYPE[grepl('hurric',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('typh',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('ice.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[26]
storm_us$EVTYPE[grepl('lightning',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[29]
storm_us$EVTYPE[grepl('marine.*hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[30]
storm_us$EVTYPE[grepl('rip.*cur',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[34]
storm_us$EVTYPE[grepl('sleet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[36]
storm_us$EVTYPE[grepl('High Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('thunderstorm|tstm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[39]
storm_us$EVTYPE[grepl('tornado',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tornado debris',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tropical.*depression',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[41]
storm_us$EVTYPE[grepl('tropical.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[42]
storm_us$EVTYPE[grepl('volcanic.*ash',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[44]
storm_us$EVTYPE[grepl('waterspout',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[45]
storm_us$EVTYPE[grepl('fire',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[46]
storm_us$EVTYPE[grepl('wint.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[47]
storm_us$EVTYPE[grepl('wint',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[48]
length(levels(storm_us$EVTYPE))
length(unique(storm_us$EVTYPE))
length(unique(storm$EVTYPE))
names(storm$EVTYPE)
unique(storm$EVTYPE)
unique(storm_us$EVTYPE)
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
sum(unique(storm_us$EVTYPE))
length(unique(storm_us$EVTYPE))
unique(storm_us$EVTYPE)
storm_us <- storm_us[!grepl('fire',storm_us$EVTYPE,ignore.case = TRUE),]
unique(storm_us$EVTYPE)
unique(storm_us$EVTYPE)
storm_us <- storm_us[!grepl('summary',storm_us$EVTYPE,ignore.case = TRUE),]
unique(storm_us$EVTYPE)
sum(grepl('summary',storm_us$EVTYPE,ignore.case = TRUE))
sum(grepl('summary',storm$EVTYPE,ignore.case = TRUE))
length(unique(storm_us$EVTYPE))
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
official_storm_events <- c("Astronomical Low Tide","Avalanche","Blizzard","Coastal Flood","Cold/Wind Chill","Debris Flow","Dense Fog","Dense Smoke","Drought","Dust Devil","Dust Storm","Excessive Heat","Extreme Cold/Wind Chill","Flash Flood","Flood","Frost/Freeze","Funnel Cloud","Freezing Fog","Hail","Heat","Heavy Rain","Heavy Snow","High Surf","High Wind","Hurricane/Typhoon","Ice Storm","Lake-Effect Snow","Lakeshore Flood","Lightning","Marine Hail","Marine High Wind","Marine Strong Wind","Marine Thunderstorm Wind","Rip Current","Seiche","Sleet","Storm Surge/Tide","Strong Wind","Thunderstorm Wind","Tornado","Tropical Depression","Tropical Storm","Tsunami","Volcanic Ash","Waterspout","Wildfire","Winter Storm","Winter Weather")
official_storm_events <- toupper(official_storm_events)
storm_us$EVTYPE[grepl('Low Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[1]
storm_us$EVTYPE[grepl('^avala',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[2]
storm_us$EVTYPE[grepl('blizz',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[3]
storm_us$EVTYPE[grepl('cold|wind.*chill|cool|low temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[5]
storm_us$EVTYPE[grepl('dense fog',storm_us$EVTYPE,ignore.case = TRUE) | grepl('^fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[7]
storm_us$EVTYPE[grepl('smoke',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[8]
storm_us$EVTYPE[grepl('drought|dry',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[9]
storm_us$EVTYPE[grepl('dust.*dev',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[10]
storm_us$EVTYPE[grepl('dust',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('devil',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[11]
storm_us$EVTYPE[grepl('flood',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[15]
storm_us$EVTYPE[grepl('frost|freez',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[16]
storm_us$EVTYPE[grepl('funnel',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[17]
storm_us$EVTYPE[grepl('fog.*cold',storm_us$EVTYPE,ignore.case = TRUE) | grepl('ice.*fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[18]
storm_us$EVTYPE[grepl('hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[19]
storm_us$EVTYPE[grepl('heat|warm|hot|high temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[20]
storm_us$EVTYPE[grepl('rain|precipitation|shower|wet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[21]
storm_us$EVTYPE[grepl('snow',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[22]
storm_us$EVTYPE[grepl('surf|high wave|high swell|high seas',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[23]
storm_us$EVTYPE[grepl('wind',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('marine',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('thunderstorm|tstm.*wind',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[24]
storm_us$EVTYPE[grepl('hurric',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('typh',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('ice.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[26]
storm_us$EVTYPE[grepl('lightning',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[29]
storm_us$EVTYPE[grepl('marine.*hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[30]
storm_us$EVTYPE[grepl('rip.*cur',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[34]
storm_us$EVTYPE[grepl('sleet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[36]
storm_us$EVTYPE[grepl('High Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('Coastal Surge',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('thunderstorm|tstm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[39]
storm_us$EVTYPE[grepl('tornado',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tornado debris',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tropical.*depression',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[41]
storm_us$EVTYPE[grepl('tropical.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[42]
storm_us$EVTYPE[grepl('volcanic.*ash',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[44]
storm_us$EVTYPE[grepl('waterspout',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[45]
storm_us$EVTYPE[grepl('fire',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[46]
storm_us$EVTYPE[grepl('wint.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[47]
storm_us$EVTYPE[grepl('wint',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[48]
length(unique(storm_us$EVTYPE))
storm_us <- storm_us[!grepl('summary',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('?',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('other',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('temperature record',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('marine accident',storm_us$EVTYPE,ignore.case = TRUE),]
length(unique(storm_us$EVTYPE))
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
storm_us$EVTYPE[grepl('Low Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[1]
storm_us$EVTYPE[grepl('^avala',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[2]
storm_us$EVTYPE[grepl('blizz',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[3]
storm_us$EVTYPE[grepl('cold|wind.*chill|cool|low temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[5]
storm_us$EVTYPE[grepl('dense fog',storm_us$EVTYPE,ignore.case = TRUE) | grepl('^fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[7]
storm_us$EVTYPE[grepl('smoke',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[8]
storm_us$EVTYPE[grepl('drought|dry',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[9]
storm_us$EVTYPE[grepl('dust.*dev',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[10]
storm_us$EVTYPE[grepl('dust',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('devil',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[11]
storm_us$EVTYPE[grepl('flood',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[15]
storm_us$EVTYPE[grepl('frost|freez',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[16]
storm_us$EVTYPE[grepl('funnel',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[17]
storm_us$EVTYPE[grepl('fog.*cold',storm_us$EVTYPE,ignore.case = TRUE) | grepl('ice.*fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[18]
storm_us$EVTYPE[grepl('hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[19]
storm_us$EVTYPE[grepl('heat|warm|hot|high temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[20]
storm_us$EVTYPE[grepl('rain|precipitation|shower|wet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[21]
storm_us$EVTYPE[grepl('snow',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[22]
storm_us$EVTYPE[grepl('surf|high wave|high swell|high seas',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[23]
storm_us$EVTYPE[grepl('wind',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('marine',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('thunderstorm|tstm.*wind',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[24]
storm_us$EVTYPE[grepl('hurric',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('typh',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('ice.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[26]
storm_us$EVTYPE[grepl('lightning',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[29]
storm_us$EVTYPE[grepl('marine.*hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[30]
storm_us$EVTYPE[grepl('rip.*cur',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[34]
storm_us$EVTYPE[grepl('sleet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[36]
storm_us$EVTYPE[grepl('High Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('Coastal Surge',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('thunderstorm|tstm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[39]
storm_us$EVTYPE[grepl('tornado',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tornado debris',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tropical.*depression',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[41]
storm_us$EVTYPE[grepl('tropical.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[42]
storm_us$EVTYPE[grepl('volcanic.*ash',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[44]
storm_us$EVTYPE[grepl('waterspout',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[45]
storm_us$EVTYPE[grepl('fire',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[46]
storm_us$EVTYPE[grepl('wint.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[47]
storm_us$EVTYPE[grepl('wint',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[48]
dim(storm_us)
storm_us <- storm_us[!grepl('summary',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('other',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('temperature record',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('marine accident',storm_us$EVTYPE,ignore.case = TRUE),]
dim(storm_us)
length(unique(storm_us$EVTYPE))
levels(storm_us$PROPDMGEXP)
levels(storm_us$CROPDMGEXP)
levels(storm_us$CROPDMGEXP)<-tolower(levels(storm_us$CROPDMGEXP))
levels(storm_us$PROPDMGEXP)<-tolower(levels(storm_us$PROPDMGEXP))
levels(storm_us$PROPDMGEXP)
levels(storm_us$CROPDMGEXP)
levels(storm_us$CROPDMGEXP)[levels(storm_us$CROPDMGEXP)=="b"]<-"9"
levels(storm_us$CROPDMGEXP)[levels(storm_us$CROPDMGEXP)=="k"]<-"3"
levels(storm_us$CROPDMGEXP)[levels(storm_us$CROPDMGEXP)=="m"]<-"6"
levels(storm_us$CROPDMGEXP)[levels(storm_us$CROPDMGEXP)=="?"]<-"0"
levels(storm_us$CROPDMGEXP)[levels(storm_us$CROPDMGEXP)==""]<-"0"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)=="b"]<-"9"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)=="k"]<-"3"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)=="h"]<-"2"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)=="m"]<-"6"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)=="?"]<-"0"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)==""]<-"0"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)=="+"]<-"0"
levels(storm_us$PROPDMGEXP)[levels(storm_us$PROPDMGEXP)=="-"]<-"0"
levels(storm_us$PROPDMGEXP)
levels(storm_us$CROPDMGEXP)
levels(storm_us$PROPDMGEXP)
levels(storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- as.numeric(storm_us$CROPDMGEXP)
storm_us$PROPDMGEXP <- as.numeric(storm_us$PROPDMGEXP)
dim(storm_us)
library(dplyr)
storm_us <- mutate(storm_us, totalpropdmg = PROPDMG * 10^PROPDMGEXP,totalcropdmg = CROPDMG * 10^CROPDMGEXP)
dim(storm_us)
dim(storm_us)
unique(storm_us$STATE__)
length(unique(storm_us$EVTYPE))
length(unique(storm_us$EVTYPE))
dim(storm_us)
head(storm_us)
unique(storm_us$PROPDMGEXP)
unique(storm_us$CROPDMGEXP)
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
storm_us$EVTYPE[grepl('Low Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[1]
storm_us$EVTYPE[grepl('^avala',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[2]
storm_us$EVTYPE[grepl('blizz',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[3]
storm_us$EVTYPE[grepl('cold|wind.*chill|cool|low temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[5]
storm_us$EVTYPE[grepl('dense fog',storm_us$EVTYPE,ignore.case = TRUE) | grepl('^fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[7]
storm_us$EVTYPE[grepl('smoke',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[8]
storm_us$EVTYPE[grepl('drought|dry',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[9]
storm_us$EVTYPE[grepl('dust.*dev',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[10]
storm_us$EVTYPE[grepl('dust',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('devil',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[11]
storm_us$EVTYPE[grepl('flood',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[15]
storm_us$EVTYPE[grepl('frost|freez',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[16]
storm_us$EVTYPE[grepl('funnel',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[17]
storm_us$EVTYPE[grepl('fog.*cold',storm_us$EVTYPE,ignore.case = TRUE) | grepl('ice.*fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[18]
storm_us$EVTYPE[grepl('hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[19]
storm_us$EVTYPE[grepl('heat|warm|hot|high temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[20]
storm_us$EVTYPE[grepl('rain|precipitation|shower|wet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[21]
storm_us$EVTYPE[grepl('snow',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[22]
storm_us$EVTYPE[grepl('surf|high wave|high swell|high seas',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[23]
storm_us$EVTYPE[grepl('wind',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('marine',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('thunderstorm|tstm.*wind',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[24]
storm_us$EVTYPE[grepl('hurric',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('typh',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('ice.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[26]
storm_us$EVTYPE[grepl('lightning',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[29]
storm_us$EVTYPE[grepl('marine.*hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[30]
storm_us$EVTYPE[grepl('rip.*cur',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[34]
storm_us$EVTYPE[grepl('sleet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[36]
storm_us$EVTYPE[grepl('High Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('Coastal Surge',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('thunderstorm|tstm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[39]
storm_us$EVTYPE[grepl('tornado',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tornado debris',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tropical.*depression',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[41]
storm_us$EVTYPE[grepl('tropical.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[42]
storm_us$EVTYPE[grepl('volcanic.*ash',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[44]
storm_us$EVTYPE[grepl('waterspout',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[45]
storm_us$EVTYPE[grepl('fire',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[46]
storm_us$EVTYPE[grepl('wint.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[47]
storm_us$EVTYPE[grepl('wint',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[48]
storm_us <- storm_us[!grepl('summary',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('other',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('temperature record',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('marine accident',storm_us$EVTYPE,ignore.case = TRUE),]
length(unique(storm_us$EVTYPE))
unique(storm_us$PROPDMGEXP)
unique(storm_us$CROPDMGEXP)
class(storm_us)
head(storm_us)
storm_us$CROPDMGEXP<-tolower(storm_us$CROPDMGEXP)
storm_us$PROPDMGEXP<-tolower(storm_us$PROPDMGEXP)
unique(storm_us$PROPDMGEXP)
unique(storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('b','9',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('k','3',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('m','6',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('?','0',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('','0',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('b','9',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('k','3',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('h','2',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('m','6',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('?','0',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('','0',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('+','0',storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub('-','0',storm_us$CROPDMGEXP)
unique(storm_us$PROPDMGEXP)
unique(storm_us$CROPDMGEXP)
?sub
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
a <- storm_us
a
dim(a)
class(storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP
sub("b","9",storm_us$CROPDMGEXP)
class(storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP  <- as.character(storm_us$PROPDMGEXP )
class(storm_us$PROPDMGEXP)
unique(storm_us$PROPDMGEXP)
unique(storm_us$PROPDMGEXP)storm_us$PROPDMGEXP<-tolower(storm_us$PROPDMGEXP)
unique(storm_us$PROPDMGEXP)storm_us$PROPDMGEXP<-tolower(storm_us$PROPDMGEXP)storm_us$PROPDMGEXP<-tolower(storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP<-tolower(storm_us$PROPDMGEXP)
unique(storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("b","9",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("k","3",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("h","2",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("m","6",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("?","0",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("+","0",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("-","0",storm_us$PROPDMGEXP)
unique(storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- as.numeric(storm_us$PROPDMGEXP)
unique(storm_us$PROPDMGEXP)
storm <- storm_raw[,c("STATE__","EVTYPE","FATALITIES","INJURIES","PROPDMG","PROPDMGEXP","CROPDMG","CROPDMGEXP")]
storm_us <- storm[storm$STATE__ >= 1 & storm$STATE__ <= 56,]
official_storm_events <- c("Astronomical Low Tide","Avalanche","Blizzard","Coastal Flood","Cold/Wind Chill","Debris Flow","Dense Fog","Dense Smoke","Drought","Dust Devil","Dust Storm","Excessive Heat","Extreme Cold/Wind Chill","Flash Flood","Flood","Frost/Freeze","Funnel Cloud","Freezing Fog","Hail","Heat","Heavy Rain","Heavy Snow","High Surf","High Wind","Hurricane/Typhoon","Ice Storm","Lake-Effect Snow","Lakeshore Flood","Lightning","Marine Hail","Marine High Wind","Marine Strong Wind","Marine Thunderstorm Wind","Rip Current","Seiche","Sleet","Storm Surge/Tide","Strong Wind","Thunderstorm Wind","Tornado","Tropical Depression","Tropical Storm","Tsunami","Volcanic Ash","Waterspout","Wildfire","Winter Storm","Winter Weather")
official_storm_events <- toupper(official_storm_events)
occurence <- function(x){dim(storm_us[grep(x,storm_us$EVTYPE,ignore.case = TRUE),])[1]}
ose_occurence <- sapply(official_storm_events,occurence)
ose_occurence
sum(ose_occurence)
nrow(storm_us)
storm_us$EVTYPE[grepl('Low Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[1]
storm_us$EVTYPE[grepl('^avala',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[2]
storm_us$EVTYPE[grepl('blizz',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[3]
storm_us$EVTYPE[grepl('cold|wind.*chill|cool|low temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[5]
storm_us$EVTYPE[grepl('dense fog',storm_us$EVTYPE,ignore.case = TRUE) | grepl('^fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[7]
storm_us$EVTYPE[grepl('smoke',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[8]
storm_us$EVTYPE[grepl('drought|dry',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[9]
storm_us$EVTYPE[grepl('dust.*dev',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[10]
storm_us$EVTYPE[grepl('dust',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('devil',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[11]
storm_us$EVTYPE[grepl('flood',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[15]
storm_us$EVTYPE[grepl('frost|freez',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[16]
storm_us$EVTYPE[grepl('funnel',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[17]
storm_us$EVTYPE[grepl('fog.*cold',storm_us$EVTYPE,ignore.case = TRUE) | grepl('ice.*fog',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[18]
storm_us$EVTYPE[grepl('hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[19]
storm_us$EVTYPE[grepl('heat|warm|hot|high temp',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[20]
storm_us$EVTYPE[grepl('rain|precipitation|shower|wet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[21]
storm_us$EVTYPE[grepl('snow',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[22]
storm_us$EVTYPE[grepl('surf|high wave|high swell|high seas',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[23]
storm_us$EVTYPE[grepl('wind',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('marine',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('thunderstorm|tstm.*wind',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[24]
storm_us$EVTYPE[grepl('hurric',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('typh',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[25]
storm_us$EVTYPE[grepl('ice.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[26]
storm_us$EVTYPE[grepl('lightning',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[29]
storm_us$EVTYPE[grepl('marine.*hail',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[30]
storm_us$EVTYPE[grepl('rip.*cur',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[34]
storm_us$EVTYPE[grepl('sleet',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[36]
storm_us$EVTYPE[grepl('High Tide',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('Coastal Surge',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[37]
storm_us$EVTYPE[grepl('thunderstorm|tstm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[39]
storm_us$EVTYPE[grepl('tornado',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tornado debris',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[40]
storm_us$EVTYPE[grepl('tropical.*depression',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[41]
storm_us$EVTYPE[grepl('tropical.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[42]
storm_us$EVTYPE[grepl('volcanic.*ash',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[44]
storm_us$EVTYPE[grepl('waterspout',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[45]
storm_us$EVTYPE[grepl('fire',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[46]
storm_us$EVTYPE[grepl('wint.*storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[47]
storm_us$EVTYPE[grepl('wint',storm_us$EVTYPE,ignore.case = TRUE) & !grepl('storm',storm_us$EVTYPE,ignore.case = TRUE)]<-official_storm_events[48]
storm_us <- storm_us[!grepl('summary',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('other',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('temperature record',storm_us$EVTYPE,ignore.case = TRUE),]
storm_us <- storm_us[!grepl('marine accident',storm_us$EVTYPE,ignore.case = TRUE),]
unique(storm_us$PROPDMGEXP)
unique(storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP<-tolower(storm_us$CROPDMGEXP)
storm_us$PROPDMGEXP<-tolower(storm_us$PROPDMGEXP)
# transforming the characters into their corresponding numerical exponentials
storm_us$CROPDMGEXP <- sub("b","9",storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub("k","3",storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub("m","6",storm_us$CROPDMGEXP)
storm_us$CROPDMGEXP <- sub("?","0",storm_us$CROPDMGEXP)
storm_us$PROPDMGEXP <- sub("b","9",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("k","3",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("h","2",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("m","6",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("?","0",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("+","0",storm_us$PROPDMGEXP)
storm_us$PROPDMGEXP <- sub("-","0",storm_us$PROPDMGEXP)
# Moreover I transform the exponential variables from factors to numerical values
storm_us$CROPDMGEXP <- as.numeric(storm_us$CROPDMGEXP)
storm_us$PROPDMGEXP <- as.numeric(storm_us$PROPDMGEXP)
# Now we change the NA values to 0s
storm_us$PROPDMGEXP[is.na(storm_us$PROPDMGEXP)]<-0
storm_us$CROPDMGEXP[is.na(storm_us$CROPDMGEXP)]<-0
# To double check, the levels are now:
unique(storm_us$PROPDMGEXP)
unique(storm_us$CROPDMGEXP)
library(dplyr)
storm_us <- mutate(storm_us, totalpropdmg = PROPDMG * 10^PROPDMGEXP,totalcropdmg = CROPDMG * 10^CROPDMGEXP)
head(storm_us)
dim(storm_us)
storm_us <- mutate(storm_us, TOTALHARM = FATALITIES + INJURIES)
head(storm_us)
storm_us <- select(storm_us, EVTYPE, FATALITIES,TOTALHARM, INJURIES, TOTALPROPDMG, TOTALCROPDMG)
storm_us <- select(storm_us, EVTYPE, FATALITIES,TOTALHARM, INJURIES, totalpropdmg, totalcropdmg)
head(storm_us)
storm_us <- select(storm_us, EVTYPE, FATALITIES,TOTALHARM, INJURIES, totalpropdmg, totalcropdmg) %>% group_by(EVTYPE)
head(storm_us)
dim(storm_us)
storm_us <- select(storm_us, EVTYPE, FATALITIES,TOTALHARM, INJURIES, totalpropdmg, totalcropdmg) %>% group_by(EVTYPE) %>% sumarise_each
storm_us <- select(storm_us, EVTYPE, FATALITIES,TOTALHARM, INJURIES, totalpropdmg, totalcropdmg) %>% group_by(EVTYPE) %>% summarise_each
?summarise_each
storm_us <- select(storm_us, EVTYPE, FATALITIES,TOTALHARM, INJURIES, totalpropdmg, totalcropdmg) %>% group_by(EVTYPE) %>% summarise_each(funs(sum))
head(storm_us)
dim(storm_us)
storm_us <- select(storm_us, EVTYPE, FATALITIES,TOTALHARM, INJURIES, totalpropdmg, totalcropdmg) %>% group_by(EVTYPE) %>% summarise_each(funs(sum))
storm_us_totalharm <- arrange(storm_us, desc(TOTALHARM))
head(storm_us_totalharm)
storm_us_totalharm[1:10,]
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = EVTYPE, y = TOTALHARM)) + geom_bar(stat = 'identity', fill = 'white', color = 'black') +
coord_flip() +
theme(axis.text = element_text(size = 8)) +
ggtitle("Impact of Weather Events on Population Health") +
xlab("Event type") +
ylab("Fatalities and Injuries (12/1/2003 - 11/30/2011)")
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = TOTALHARM, y = EVTYPE)) + geom_bar(stat = 'identity', fill = 'white', color = 'black') +
coord_flip() +
theme(axis.text = element_text(size = 8)) +
ggtitle("Impact of Weather Events on Population Health") +
xlab("Event type") +
ylab("Fatalities and Injuries (12/1/2003 - 11/30/2011)")
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = EVTYPE, y = TOTALHARM)) + geom_bar(stat = 'identity', fill = 'white', color = 'black') +
coord_flip() +
theme(axis.text = element_text(size = 8)) +
ggtitle("Impact of Weather Events on Population Health") +
xlab("Event type") +
ylab("Fatalities and Injuries (12/1/2003 - 11/30/2011)")
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = EVTYPE, y = TOTALHARM)) + geom_bar(stat = 'identity', fill = 'white', color = 'black') +
theme(axis.text = element_text(size = 8)) +
ggtitle("Impact of Weather Events on Population Health") +
xlab("Event type") +
ylab("Fatalities and Injuries (12/1/2003 - 11/30/2011)")
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = EVTYPE, y = TOTALHARM)) + geom_bar(stat = 'identity', fill = 'blue', color = 'black') +
theme(axis.text = element_text(size = 18)) +
ggtitle("Impact of the weather events in the U.S. in terms of harm on the population") +
xlab("Event type") +
ylab("Total harming events (fatalities + injuries)")
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = EVTYPE, y = TOTALHARM)) + geom_bar(stat = 'identity', fill = 'blue', color = 'black') +
theme(axis.text = element_text(size = 14)) +
ggtitle("Impact of the weather events in the U.S. in terms of harm on the population") +
xlab("Event type") +
ylab("Total harming events (fatalities + injuries)")
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = EVTYPE, y = TOTALHARM)) + geom_bar(stat = 'identity', fill = 'blue', color = 'black') +
theme(axis.text = element_text(size = 14)) +
ggtitle("Impact of the top 10 harmful weather events in the U.S. for the population") +
xlab("Event type") +
ylab("Total harming events (fatalities + injuries)")
library(ggplot2)
ggplot(storm_us_totalharm[1:10,], aes(x = EVTYPE, y = TOTALHARM)) + geom_bar(stat = 'identity', fill = 'blue', color = 'black') +
theme(axis.text = element_text(size = 14)) +
ggtitle("Impact of the top 10 harmful weather events in the U.S. for the population") +
xlab("Event type") +
ylab("Total harm (fatalities + injuries)")
storm_us <- mutate(storm_us, TOTALHARM = FATALITIES + INJURIES, TOTALDMG = TOTALPROPDMG + TOTALCROPDMG)
head(storm_us)
storm_us <- mutate(storm_us, TOTALHARM = FATALITIES + INJURIES, TOTALDMG = totalpropdmg + totalcropdmg)
storm_us_totaldmg <- arrange(storm_us, desc(TOTALDMG))
head(storm_us_totaldmg,10)
ggplot(storm_us_totaldmg[1:10,], aes(x = EVTYPE, y = TOTALDMG)) + geom_bar(stat = 'identity', fill = 'blue', color = 'black') +
theme(axis.text = element_text(size = 14)) +
ggtitle("Impact of top 10 harmful weather events in the U.S. for population") +
xlab("Event type") +
ylab("Total harm (fatalities + injuries)") +
theme(axis.text.x = element_text(angle = 30, hjust = 1, color = 'black', size=12),
legend.position='none')
